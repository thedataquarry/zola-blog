<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="light dark" name=color-scheme><title>How Rust 🦀 is supercharging Python from the ground up | The Data Quarry</title><meta content="How Rust 🦀 is supercharging Python from the ground up" property=og:title><meta content="Prashanth Rao" name=author><meta content=en_US property=og:locale><meta content="How mature, low-level tooling in Rust is causing a transformation in the PyData ecosystem" name=description><meta content="How mature, low-level tooling in Rust is causing a transformation in the PyData ecosystem" property=og:description><link href=https://thedataquarry.github.io/posts/rust-is-supercharging-python/ rel=canonical><meta content=https://thedataquarry.github.io/posts/rust-is-supercharging-python/ property=og:url><meta content="The Data Quarry" property=og:site_name><meta content=https://thedataquarry.github.io/img/dataquarry-banner.png property=og:image><meta content=article property=og:type><meta content=2023-06-15T00:00:00+00:00 property=article:published_time><meta " content=summary_large_image name=twitter:card><meta content=https://thedataquarry.github.io/img/dataquarry-banner.png property=twitter:image><meta content="How Rust 🦀 is supercharging Python from the ground up" property=twitter:title><meta content=@tech_optimist name=twitter:site><meta content="How mature, low-level tooling in Rust is causing a transformation in the PyData ecosystem" name=description><title>How Rust 🦀 is supercharging Python from the ground up</title><link href=/img/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/img/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/img/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><style>body{--primary-color:#376dd9;--primary-pale-color:#698bcf1c;--inline-code-color:#444;--text-color:#444;--text-pale-color:#545967;--bg-color:#fff;--highlight-mark-color:#5f75b045;--callout-note-color:#3e70d6;--callout-important-color:#7a46cd;--callout-warning-color:#d3822b;--callout-alert-color:#d43f3f;--callout-question-color:#3089b5;--callout-tip-color:#35a06b;--main-font:"IBMPlexSans",ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--code-font:"IBMPlexMono",ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--homepage-max-width:750px;--main-max-width:750px;--avatar-size:175px;--paragraph-font-size:16px;--paragraph-line-height:1.5em;--aside-font-size:16px;--img-border-radius:4px;--inline-code-border-radius:2px}body.dark{--primary-color:#689afd;--primary-pale-color:#93acdd1c;--inline-code-color:#d2d2d2;--text-color:#ddd;--text-pale-color:#a0a0a0;--bg-color:#202124;--highlight-mark-color:#5f75b045;--callout-note-color:#698bcf;--callout-important-color:#9374c5;--callout-warning-color:#c99054;--callout-alert-color:#d35757;--callout-question-color:#5091b2;--callout-tip-color:#3ea06f}</style><link href=/main.css rel=stylesheet><script async data-website-id=01228822-c189-4b8a-93ba-733d045bf346 src=https://analytics.eu.umami.is/script.js></script><body class=post><script>if(localStorage.getItem('theme')=='dark'){document.body.classList.add('dark');const a=document.querySelector('link#hl');if(a)a.href='/hl-dark.css'}</script><header class=blur><div id=header-wrapper><nav><a href=/>The Data Quarry</a><button aria-label="toggle expand" class=separator id=toggler>::</button><span class="wrap left fold">{</span><a href=/posts>blog</a><span class="wrap-separator fold">,</span><a class=fold href=/talks>talks</a><span class="wrap-separator fold">,</span><a class=fold href=/projects>projects</a><span class="wrap right fold">} ;</span></nav><div id=btns><a rel="noreferrer noopener" aria-label=GitHub href=https://github.com/prrao87 target=_blank> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" fill=currentColor></path></svg> </a><a rel="noreferrer noopener" aria-label=Twitter href=https://twitter.com/tech_optimist target=_blank> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><title>Twitter</title><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z" fill=currentColor></path></svg> </a><a rel="noreferrer noopener" aria-label=LinkedIn href=https://www.linkedin.com/in/prrao87 target=_blank> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" fill=currentColor></path></svg> </a><a aria-label="Buy me a coffee" rel="noreferrer noopener" href=https://www.buymeacoffee.com/prrao87 target=_blank> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><title>Buy Me A Coffee</title><path d="M20.216 6.415l-.132-.666c-.119-.598-.388-1.163-1.001-1.379-.197-.069-.42-.098-.57-.241-.152-.143-.196-.366-.231-.572-.065-.378-.125-.756-.192-1.133-.057-.325-.102-.69-.25-.987-.195-.4-.597-.634-.996-.788a5.723 5.723 0 00-.626-.194c-1-.263-2.05-.36-3.077-.416a25.834 25.834 0 00-3.7.062c-.915.083-1.88.184-2.75.5-.318.116-.646.256-.888.501-.297.302-.393.77-.177 1.146.154.267.415.456.692.58.36.162.737.284 1.123.366 1.075.238 2.189.331 3.287.37 1.218.05 2.437.01 3.65-.118.299-.033.598-.073.896-.119.352-.054.578-.513.474-.834-.124-.383-.457-.531-.834-.473-.466.074-.96.108-1.382.146-1.177.08-2.358.082-3.536.006a22.228 22.228 0 01-1.157-.107c-.086-.01-.18-.025-.258-.036-.243-.036-.484-.08-.724-.13-.111-.027-.111-.185 0-.212h.005c.277-.06.557-.108.838-.147h.002c.131-.009.263-.032.394-.048a25.076 25.076 0 013.426-.12c.674.019 1.347.067 2.017.144l.228.031c.267.04.533.088.798.145.392.085.895.113 1.07.542.055.137.08.288.111.431l.319 1.484a.237.237 0 01-.199.284h-.003c-.037.006-.075.01-.112.015a36.704 36.704 0 01-4.743.295 37.059 37.059 0 01-4.699-.304c-.14-.017-.293-.042-.417-.06-.326-.048-.649-.108-.973-.161-.393-.065-.768-.032-1.123.161-.29.16-.527.404-.675.701-.154.316-.199.66-.267 1-.069.34-.176.707-.135 1.056.087.753.613 1.365 1.37 1.502a39.69 39.69 0 0011.343.376.483.483 0 01.535.53l-.071.697-1.018 9.907c-.041.41-.047.832-.125 1.237-.122.637-.553 1.028-1.182 1.171-.577.131-1.165.2-1.756.205-.656.004-1.31-.025-1.966-.022-.699.004-1.556-.06-2.095-.58-.475-.458-.54-1.174-.605-1.793l-.731-7.013-.322-3.094c-.037-.351-.286-.695-.678-.678-.336.015-.718.3-.678.679l.228 2.185.949 9.112c.147 1.344 1.174 2.068 2.446 2.272.742.12 1.503.144 2.257.156.966.016 1.942.053 2.892-.122 1.408-.258 2.465-1.198 2.616-2.657.34-3.332.683-6.663 1.024-9.995l.215-2.087a.484.484 0 01.39-.426c.402-.078.787-.212 1.074-.518.455-.488.546-1.124.385-1.766zm-1.478.772c-.145.137-.363.201-.578.233-2.416.359-4.866.54-7.308.46-1.748-.06-3.477-.254-5.207-.498-.17-.024-.353-.055-.47-.18-.22-.236-.111-.71-.054-.995.052-.26.152-.609.463-.646.484-.057 1.046.148 1.526.22.577.088 1.156.159 1.737.212 2.48.226 5.002.19 7.472-.14.45-.06.899-.13 1.345-.21.399-.072.84-.206 1.08.206.166.281.188.657.162.974a.544.544 0 01-.169.364zm-6.159 3.9c-.862.37-1.84.788-3.109.788a5.884 5.884 0 01-1.569-.217l.877 9.004c.065.78.717 1.38 1.5 1.38 0 0 1.243.065 1.658.065.447 0 1.786-.065 1.786-.065.783 0 1.434-.6 1.499-1.38l.94-9.95a3.996 3.996 0 00-1.322-.238c-.826 0-1.491.284-2.26.613z" fill=currentColor></path></svg> </a><button aria-label="theme switch" data-moon-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.9417 4 12Z" fill="currentColor"></path></svg>' data-sun-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z" fill="currentColor"></path></svg>' id=theme-toggle><svg viewbox="0 0 24 24" height=24 width=24 xmlns=http://www.w3.org/2000/svg><path d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.9417 4 12Z" fill=currentColor></path></svg></button><button aria-label="table of content" id=toc-toggle><svg viewbox="0 0 24 24" height=24 width=24 xmlns=http://www.w3.org/2000/svg><path d="M3 4H21V6H3V4ZM3 11H15V13H3V11ZM3 18H21V20H3V18Z" fill=currentColor></path></svg></button></div></div></header><div id=wrapper><div id=blank></div><aside class=blur><nav><ul><li><a class=h2 href=#rust-crab-is-eating-the-pydata-ecosystem>Rust 🦀 is eating the PyData ecosystem</a><li><a class=h2 href=#what-makes-for-a-widely-adopted-language>What makes for a widely adopted language?</a><li><a class=h2 href=#a-confluence-of-great-tooling>A confluence of great tooling</a><li><a class=h2 href=#pyo3-and-what-makes-it-amazing>PyO3 and what makes it amazing</a> <ul><li><a class=h3 href=#how-pyo3-gives-python-package-developers-superpowers>How PyO3 gives Python package developers superpowers</a></ul><li><a class=h2 href=#the-rise-of-fire-rust-web-servers>The rise of 🔥 Rust web servers</a><li><a class=h2 href=#enabling-future-database-systems>Enabling future database systems</a> <ul><li><a class=h3 href=#surrealdb-from-golang-to-rust>SurrealDB: From Golang to Rust</a><li><a class=h3 href=#lancedb-from-c-to-rust>LanceDB: From C++ to Rust</a></ul><li><a class=h2 href=#arrow-and-polars>Arrow and Polars</a><li><a class=h2 href=#datafusion-and-ballista>DataFusion and Ballista</a> <ul><li><a class=h3 href=#what-is-datafusion>What is DataFusion?</a><li><a class=h3 href=#ballista-bow-and-arrow>Ballista 🏹</a></ul><li><a class=h2 href=#pydantic>Pydantic</a><li><a class=h2 href=#delta-lake>Delta Lake</a><li><a class=h2 href=#daft>Daft</a><li><a class=h2 href=#gathering-the-pieces>Gathering the pieces</a><li><a class=h2 href=#conclusions>Conclusions</a></ul></nav><button aria-label="back to top" id=back-to-top><svg viewbox="0 0 24 24" height=24 width=24 xmlns=http://www.w3.org/2000/svg><path d="M11.9997 10.8284L7.04996 15.7782L5.63574 14.364L11.9997 8L18.3637 14.364L16.9495 15.7782L11.9997 10.8284Z" fill=currentColor></path></svg></button></aside><main><div><div data-check-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z" fill="currentColor"></path></svg>' data-copy-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z" fill="currentColor"></path></svg>' id=copy-cfg style=display:none></div><article data-backlink-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M9.41421 8L18.0208 16.6066L16.6066 18.0208L8 9.41421V17H6V6H17V8H9.41421Z" fill="currentColor"></path></svg>' class=prose><h1>How Rust 🦀 is supercharging Python from the ground up</h1><div id=post-info><div id=date><span id=publish>2023-06-15</span></div><div id=tags><a href=https://thedataquarry.github.io/tags/rust><span>#</span>rust</a></div></div><h2 id=rust-crab-is-eating-the-pydata-ecosystem>Rust 🦀 is eating the PyData ecosystem<a aria-label="Anchor link for: rust-crab-is-eating-the-pydata-ecosystem" class=zola-anchor href=#rust-crab-is-eating-the-pydata-ecosystem>#</a></h2><p>Imagine you’re on a boat sailing along the current on a river. Now, imagine that the lower decks of this boat <em>are being rebuilt and modified</em> as you are on it! That’s what it feels like to be a data scientist/engineer using Python today, because, as I’ll describe in this post, there’s a silent revolution happening under the hood, with Rust slowly but surely becoming the language of choice for low-level Python tooling.<p>Having had its stable 1.0 release in 2015, the initial few years for Rust were mostly about finding its niche among systems programmers, which is the main purpose for which language was designed, and it quickly became <a rel="nofollow noreferrer" href=https://www.infoworld.com/article/3546337/rust-language-tops-stack-overflow-survey.html>the most loved programming language</a>. I won’t go too deep into why Rust is a great language, as there is a <strong><em>lot</em></strong> of content online that covers this. Fast forward to today, and we can be sure that <a href="https://www.youtube.com/watch?v=A3AdN7U24iU" rel="nofollow noreferrer">Rust is here to stay</a>, having built a robust, stable and thriving ecosystem of developers and tooling.<h2 id=what-makes-for-a-widely-adopted-language>What makes for a widely adopted language?<a aria-label="Anchor link for: what-makes-for-a-widely-adopted-language" class=zola-anchor href=#what-makes-for-a-widely-adopted-language>#</a></h2><p>For a programming language ecosystem to resonate with developers and flourish long term, merely having good language design isn’t enough. It also takes the following:<ul><li>Adoption from a core “power user” community that builds foundational tooling<li>An open, inclusive community<li>Great learning material, available largely for free<li>Buy-in from a large community of additional developers that see the need for a new language<li>Useful real world applications that justify the need and use of a new language</ul><p>It’s safe to say that, since 2015, the Rust community, and the language itself, has delivered on all counts. The following key features of Rust set it apart from a lot of other languages, making it resonate deeply with all kinds of developers.<ul><li>Blazing fast 🔥 performance<li>Memory safety<li>Great support for concurrency</ul><h2 id=a-confluence-of-great-tooling>A confluence of great tooling<a aria-label="Anchor link for: a-confluence-of-great-tooling" class=zola-anchor href=#a-confluence-of-great-tooling>#</a></h2><p>The purpose of this post is to highlight specific developments in Rust’s tooling ecosystem that have come together in a very nice way in the period between 2018-2022, which are especially exciting because their combined potential hasn’t been unleashed yet. Going back to our boat in the river analogy, the image below shows a number of streams joining a river that’s flowing from left to right. You, presumably a Python developer reading this post, are quietly sailing on a boat 🛳️ along the river!<figure><img alt="Image modified from <a href='https://travellingacrosstime.com/2015/08/23/rivers/'>here</a>" loading=lazy src=tributaries.png><figcaption>Image modified from <a href=https://travellingacrosstime.com/2015/08/23/rivers/>here</a></figcaption></figure><p>The following projects and their associated Rust crates (i.e., packages) are of interest:<ul><li><strong>Hyper + Actix web</strong>: HTTP clients and web servers<li><strong>PyO3 + Maturin</strong>: Rust bindings for Python<li><strong>Arrow</strong>: In-memory columnar data format<li><strong>DataFusion</strong>: Query parsing and processing<li><strong>Ballista</strong>: Distributed query processing</ul><p>It’s okay if the terms above don’t make complete sense yet – the goal of this post is to explain how the coming together of these tools is starting to have a broader impact on the PyData ecosystem. Read on!<h2 id=pyo3-and-what-makes-it-amazing>PyO3 and what makes it amazing<a aria-label="Anchor link for: pyo3-and-what-makes-it-amazing" class=zola-anchor href=#pyo3-and-what-makes-it-amazing>#</a></h2><p>Because Python is a dynamically-typed interpreted language, it suffers in performance compared to statically typed, compiled languages. As a result, Python always relied on lower-level systems languages to perform the heavy lifting for expensive computations (things that involve loops or iteration). In the past, these languages used to be C, C++, Cython or even Fortran.<p>It’s hard to overstate the importance of one particular Rust crate, <a rel="nofollow noreferrer" href=https://github.com/PyO3/pyo3>PyO3</a>, which first came out in 2017. PyO3 allows Rust developers to <em>very easily</em> produce Rust bindings that can be used in Python, allowing Python developers to access the full power of Rust. Although similar tools like pybind11 and SWIG exist for C++, portability and ease of sharing the binaries with end users was always a challenge, and this is where Rust + PyO3 really stands apart. The quality of Rust’s crates.io package management system, combined with a thriving community that <a rel="nofollow noreferrer" href=https://pyo3.rs/v0.19.0/>documented the project</a> really well for developers from all languages, helped bring a large number of really smart people into the Rust ecosystem.<h3 id=how-pyo3-gives-python-package-developers-superpowers>How PyO3 gives Python package developers superpowers<a aria-label="Anchor link for: how-pyo3-gives-python-package-developers-superpowers" class=zola-anchor href=#how-pyo3-gives-python-package-developers-superpowers>#</a></h3><p>PyO3 can be used to generate a native Python module from native Rust bindings. This is done on the Python side by using the <a rel="nofollow noreferrer" href=https://github.com/PyO3/maturin><code>maturin</code></a> package. As of June 2023, this package has been <a href="https://pepy.tech/project/maturin?display=monthly" rel="nofollow noreferrer">downloaded more than 9 million times</a> via the Python package index. <code>maturin</code> allows users who know (or are learning) Rust to easily expose Rust bindings to Python packages, so that the larger Python community can benefit from the performance of the underlying Rust code. To see how simple it is to set up, see <a rel="nofollow noreferrer" href=https://crates.io/crates/pyo3>the PyO3 Rust crates page</a> for details.<p>The following blog post’s title is self-explanatory, and does a great job of highlighting how and why PyO3 + <code>maturin</code> have the ability to supercharge Python workflows.<ul><li><a rel="nofollow noreferrer" href=https://ohadravid.github.io/posts/2023-03-rusty-python/>Making Python 100x faster with less than 100 lines of Rust</a></ul><h2 id=the-rise-of-fire-rust-web-servers>The rise of 🔥 Rust web servers<a aria-label="Anchor link for: the-rise-of-fire-rust-web-servers" class=zola-anchor href=#the-rise-of-fire-rust-web-servers>#</a></h2><p>Because Rust is a systems language, it’s as close to bare-metal as can be. And as a result, web servers and HTTP clients written in Rust are consistently among the fastest in existence. As of June 2023, 3 of the top 5 fastest web servers are written in Rust as per the <a href="https://www.techempower.com/benchmarks/#section=data-r21&test=composite" rel="nofollow noreferrer">TechEmpower benchmarks</a>.<figure><img loading=lazy src=web_server_benchmark.png></figure><p>In general HTTP services like <code>may-minihttp</code> and <code>hyper</code>, and web servers like <code>xitca-web</code>, <code>axum</code>, <code>actix</code> and <code>actix-web</code> allow developers to build blazing fast and performant APIs and applications that support asynchronous requests natively, in a similar way to how FastAPI foes for Python developers. All this enables other applications, like databases, to be built to expose their internals via REST APIs built in pure Rust.<h2 id=enabling-future-database-systems>Enabling future database systems<a aria-label="Anchor link for: enabling-future-database-systems" class=zola-anchor href=#enabling-future-database-systems>#</a></h2><p>In 2023, there are a number of really exciting databases being built from the ground up in Rust, as can be seen in the <a rel="nofollow noreferrer" href=https://lib.rs/database-implementations>database implementations</a> page of the Rust library index. Having worked with some of these databases (like Qdrant and Meilisearch), I can say hands down that databases built in Rust provide an <strong>amazing</strong> developer experience, both for end users, and, presumably, the people building the DBMS themselves.<p>What’s even more mind-blowing is the fact that in some cases, databases written in another language are being <em>rewritten from the ground up</em> in Rust, purely because of the benefits of the language. Two key examples are listed below.<h3 id=surrealdb-from-golang-to-rust>SurrealDB: From Golang to Rust<a aria-label="Anchor link for: surrealdb-from-golang-to-rust" class=zola-anchor href=#surrealdb-from-golang-to-rust>#</a></h3><p>The creators of SurrealDB, a NewSQL database, explain their reasoning in rewriting their <em>entire</em> code base (that was originally in Golang) in Rust: type safety, ease of reusing & distributing crates, and great support for generic types.<div class=youtube><iframe allowfullscreen mozallowfullscreen src=https://www.youtube.com/embed/Chl8IdMxr4Y webkitallowfullscreen></iframe></div><h3 id=lancedb-from-c-to-rust>LanceDB: From C++ to Rust<a aria-label="Anchor link for: lancedb-from-c-to-rust" class=zola-anchor href=#lancedb-from-c-to-rust>#</a></h3><p>LanceDB, a serverless vector database, was originally written in C++, but as its co-founder, Chang She, explains, <a rel="nofollow noreferrer" href=https://medium.com/etoai/please-pardon-our-appearance-during-renovations-da8c8f49b383>“writing in Rust felt like such a breath of fresh air”</a> – the makers of this system decided to rewrite their entire code base in Rust. 🤯<ul><li><a rel="nofollow noreferrer" href=https://blog.lancedb.com/please-pardon-our-appearance-during-renovations-da8c8f49b383>Rewriting LanceDB in Rust</a></ul><p>At the time of writing this post, LanceDB is <a rel="nofollow noreferrer" href=https://github.com/lancedb/lancedb/issues>still under active development</a>, but my initial experience with it shows it to be very performant, lightweight, and living up to all its promises of being the go-to serverless database in the future. 😎<h2 id=arrow-and-polars>Arrow and Polars<a aria-label="Anchor link for: arrow-and-polars" class=zola-anchor href=#arrow-and-polars>#</a></h2><p>The Apache Arrow ecosystem originally began in 2015, when Wes McKinney, co-creator of Pandas, was interested in developing a fast, columnar, in-memory, and most importantly, <strong>language-agnostic</strong> standard for representing data in a way that could be queried efficiently. The parquet data format came out of the Arrow spec. Although Arrow was originally written in C++, in 2019, it was also ported over to Rust in order to allow Rust developers to build foundational tooling based on the Arrow spec.<p><a rel="nofollow noreferrer" href=https://github.com/pola-rs/polars>Polars</a> is a DataFrame library written in Rust, enabled by Rust’s Arrow implementation. In multiple benchmarks, Polars has outperformed Pandas in tasks like data transformation and aggregation. In August 2023, Ritchie Vink, crator of Polars, <a rel="nofollow noreferrer" href=https://www.pola.rs/posts/company-announcement/>announced</a> that Polars received $4M in funding to start a company that can enable Polars to be used in production environments at scale, presumably on the cloud. All this is great news for the broader Rust ecosystem, in general!<h2 id=datafusion-and-ballista>DataFusion and Ballista<a aria-label="Anchor link for: datafusion-and-ballista" class=zola-anchor href=#datafusion-and-ballista>#</a></h2><p>Because relational database systems are the primary means through which companies analyze their swathes of data, it follows that an efficient SQL parsing and execution in Rust was sorely needed to complement the Arrow spec. Between 2019-2022, this was achieved largely through the efforts of one person, <a rel="nofollow noreferrer" href=https://andygrove.io/projects/>Andy Grove</a>.<h3 id=what-is-datafusion>What is DataFusion?<a aria-label="Anchor link for: what-is-datafusion" class=zola-anchor href=#what-is-datafusion>#</a></h3><p>In the 2018 blog post titled <a rel="nofollow noreferrer" href=https://andygrove.io/2018/01/rust-is-for-big-data/>“What if Spark was written from the ground up in Rust”</a>, Andy Grove mentioned how Rust was uniquely suited to some of the large-scale distributed computing challenges that Spark set out to solve. The original Apache Spark project depended on the Java Virtual Machine (JVM), which suffered from numerous performance issues due to Java serialization, and Spark in general was notoriously hard to debug, with exceptionally long stack traces that would confound most developers.<p>DataFusion, with the foundation layer of the Arrow specification, is able to address a lot of these issues, implementing a scalable, single-process SQL query engine for fast and efficient execution on multiple threads. An example is <a rel="nofollow noreferrer" href=https://github.com/influxdata/influxdb>InfluxDB</a>, a time-series database that makes heavy use of DataFusion as its query engine, and has recently been re-implemented from the ground up in Rust (see the <code>influxdb_iox</code> <a rel="nofollow noreferrer" href=https://github.com/metrico/influxdb_iox>repo</a>).<div class=youtube><iframe allowfullscreen mozallowfullscreen src=https://www.youtube.com/embed/Rii1VTn3seQ webkitallowfullscreen></iframe></div><p>DataFusion has evolved into a much <a rel="nofollow noreferrer" href=https://github.com/apache/arrow-datafusion>larger scale project</a>, and is being maintained by a community of developers as part of the Apache Software Foundation. It’s defined as “a very fast, extensible query engine for building high-quality data-centric systems in Rust, using the Apache Arrow in-memory format”. Offering both SQL and Dataframe APIs, excellent performance, built-in support for CSV, Parquet, JSON, and Avro, along with extensive customization, it’s no wonder that it’s being used as the foundation of numerous other databases and compute platforms.<h3 id=ballista-bow-and-arrow>Ballista 🏹<a aria-label="Anchor link for: ballista-bow-and-arrow" class=zola-anchor href=#ballista-bow-and-arrow>#</a></h3><p>Ballista, initially conceived by Andy Grove, is a distributed SQL query engine designed solely to scale up DataFusion (which was written for a single process) to exploit distributed computing. <a rel="nofollow noreferrer" href=https://github.com/apache/arrow-ballista>As mentioned on GitHub</a>, it implements a similar design to Apache Spark, but is written fully in Rust, and, also unlike the original Spark that used the JVM, Ballista uses the Arrow columnar format at its foundation, allowing for much more efficient data compression and parallelization. And most importantly, like the underlying Arrow and DataFusion projects, language agnosticity is at the heart of Ballista, so that numerous other programming language interfaces can be built on top of the base query engine.<p>By the end of 2022, all of the projects (Arrow’s Rust implementation, DataFusion and Ballista) were donated to the Apache Software Foundation, and the overarching goals of this suit of projects are to rebuild something along the lines of Spark from the ground up in Rust, with performance, safety, memory footprint & scalability in mind. The following video explains the Ballista architecture and vision in more detail.<div class=youtube><iframe allowfullscreen mozallowfullscreen src=https://www.youtube.com/embed/ZZHQaOap9pQ webkitallowfullscreen></iframe></div><h2 id=pydantic>Pydantic<a aria-label="Anchor link for: pydantic" class=zola-anchor href=#pydantic>#</a></h2><p>A blog post on Python and data engineering isn’t complete without mentioning the data validation library, Pydantic. Because data cleansing and type validation are repetitive tasks that are run millions or billions of times during typical ETL jobs, running these using a performance-driven language like Rust can have huge consequences in terms of carbon emissions long-term.<p>In July 2023, Pydantic v2 was released, and as I describe in <a href=../why-pydantic-v2-matters/>my other post on Pydantic</a>, because the new version is written in Rust, it’s blazing fast 🔥. Depending on your use case and how you write your code, Pydantic v2 can be up to 12x faster than v1, due to optimizations and funtionalities implemented at the lower levels in Rust.<h2 id=delta-lake>Delta Lake<a aria-label="Anchor link for: delta-lake" class=zola-anchor href=#delta-lake>#</a></h2><p>The Delta Lake open-source format has also been popular for cases that need both offline and online data (i.e., when streaming is involved). The <code>delta-rs</code> Rust project provided the foundation for this framework, allowing the development of the <a rel="nofollow noreferrer" href=https://delta-io.github.io/delta-rs/python/>Python Delta Lake library</a>. As described in the video linked below, “not everything needs a Spark cluster” 😀.<div class=youtube><iframe allowfullscreen mozallowfullscreen src=https://www.youtube.com/embed/scYz12UK-OY webkitallowfullscreen></iframe></div><h2 id=daft>Daft<a aria-label="Anchor link for: daft" class=zola-anchor href=#daft>#</a></h2><p>I’ve only recently learned of a new Python distributed DataFrame library, <a rel="nofollow noreferrer" href=https://github.com/Eventual-Inc/Daft>Daft</a>, whose internals are also written in Rust. If you’ve ever used Dask before to parallelize operations on Pandas DataFrames, Daft is aiming to be Dask on steroids 💪. Just like the other projects described earlier, Daft is built on top of Apache Arrow, but it allows data scientists/engineers to efficiently handle multi-modal data via a DataFrame interface, with the option of seamlessly moving from a single machine to a distributed cluster (leveraging the <a rel="nofollow noreferrer" href=https://github.com/ray-project/ray>Ray</a> framework).<p>The following <a rel="nofollow noreferrer" href=https://www.getdaft.io/>integrations are offered by Daft</a>, making the Rust-powered data science ecosystem in Python a better place overall!<p><img alt src=https://thedataquarry.github.io/posts/rust-is-supercharging-python/daft_integrations.png><h2 id=gathering-the-pieces>Gathering the pieces<a aria-label="Anchor link for: gathering-the-pieces" class=zola-anchor href=#gathering-the-pieces>#</a></h2><p>With this background, we can assemble the pieces of the broader Python-Rust ecosystem as follows.<p><img alt src=https://thedataquarry.github.io/posts/rust-is-supercharging-python/tools.jpeg><p>A mature ecosystem of crates (i.e., packages) in the Rust ecosystem coupled with a developer-friendly distribution framework like PyO3 and <code>maturin</code> allow an explosion 💣 of foundational libraries that will power next generation software in the PyData ecosystem. The centralization around developer tooling and specification, for e.g., Arrow, and the fact that these tools are being rewritten from the ground up in Rust, allow for downstream frameworks like DataFusion, Ballista and Delta Lake to offer distributed computing capabilities that will have a much lower memory footprint and consume far less resources (while much more efficiently using available resources), leading to blazing fast 🚀 data processing in the PyData ecosystem.<h2 id=conclusions>Conclusions<a aria-label="Anchor link for: conclusions" class=zola-anchor href=#conclusions>#</a></h2><p>Between 2018-2022, multiple key milestones have been passed in the Rust crate ecosystem that are transforming the way Python low-level tooling is built from the ground up. And, it seems, the best of it is yet to come! We already live in a world where you have the option to seamlessly switch between the following:<ul><li>EDA and data transformation in Polars<li>Data validation in Pydantic v2<li>Process data in DataFrames using the full power of your local machine on multiple threads or cores, via Polars or Daft + Ray<li>Store the data and query it in a variety of Rust-powered databases: <ul><li><a rel="nofollow noreferrer" href=https://github.com/meilisearch/meilisearch>Meilisearch</a> (scalar search with typo-tolerance and search-as-you-type speed 🔥)<li><a rel="nofollow noreferrer" href=https://github.com/qdrant/qdrant>Qdrant</a> (vector search using a client-server architecture)<li><a rel="nofollow noreferrer" href=https://github.com/lancedb/lancedb>LanceDB</a> (multi-modal vector search on an embedded DB with a serverless architecture)</ul><li>Transform data into Arrow tables and move it between your local machine, a database or a data lake (which may be written in entirely other languages like Golang or C++)</ul><p>Now, imagine the power of a future Rust-powered Spark (whatever it ends up looking like) built on DataFusion + Ballista, and being able to seamlessly switch between running your analysis on a single core on your local machine, or in a distributed fashion on a huge cluster. The thought of that (and never having to debug a JVM stack trace again) will make even the most seasoned data scientist or engineer dance with joy! 🕺💃<p>As Will Jones, maintainer of the <code>delta-rs</code> and <code>lance</code> packages, <a rel="nofollow noreferrer" href=https://www.datawill.io/posts/pandas-arrow-rust/>says</a>:<blockquote><p>Let’s have more Rust in Python’s Arrow revolution.</blockquote></article><div class=giscus></div><script async crossorigin data-category=General data-category-id=DIC_kwDOKyWhTs4CbUSt data-emit-metadata=0 data-input-position=bottom data-lang=en data-loading=lazy data-mapping=pathname data-reactions-enabled=1 data-repo=thedataquarry/thedataquarry.github.io data-repo-id=R_kgDOKyWhTg data-strict=0 data-theme=preferred_color_scheme src=https://giscus.app/client.js></script></div><footer><div class=copyright><p>© 2024 Prashanth Rao</div><div class=credits>Powered by <a rel="noreferrer noopener" href=https://www.getzola.org target=_blank>zola</a> and <a rel="noreferrer noopener" href=https://github.com/isunjn/serene target=_blank>serene</a></div></footer></main></div><script src=/js/lightense.min.js></script><script src=/js/main.js></script>